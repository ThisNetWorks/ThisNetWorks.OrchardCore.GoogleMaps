@model dynamic
@inject ISession Session
@inject IAutorouteEntries Entries
@{
    if (Model.ContentType != null)
    {
        var contentType = Model.ContentType as string;
        var query = Session.QueryIndex<GoogleMapPartIndex>(x => x.ContentType == contentType);
        var results = await query.ListAsync();
        var list = new List<DisplayMapViewModel>();
        foreach(var result in results)
        {
            Entries.TryGetEntryByContentItemId(result.ContentItemId, out var autorouteEntry);
            var item = new DisplayMapViewModel
            {
                Lat = result.Lat,
                Lng = result.Lng,
                Path = autorouteEntry.Path
            };
            list.Add(item);
        }

        var serialized = JsonConvert.SerializeObject(list, CamelCaseJsonSerializer.Settings);

        <div class="google-maps-data" data-google-maps-data='@Html.Raw(serialized)' style="display:none"></div>
    } 
}
